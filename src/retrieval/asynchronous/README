this is a asynchronous version using massage queue and multi-threads
